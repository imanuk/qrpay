<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NatWest Payment Link Test</title>
    <style>
        body { 
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }
        button {
            display: block;
            width: 100%;
            margin: 10px 0;
            padding: 15px;
            background: #1a4896;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
        }
        .debug {
            margin-top: 10px;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 4px;
            font-size: 12px;
            word-break: break-all;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>NatWest Payment Link Test</h1>
    <p>Testing different payment parameter formats for Android 15</p>
    
    <div id="linkTests"></div>

    <script>
        const testData = {
            sort: '123456',
            account: '12345678',
            name: 'Test Payment',
            amount: '10.00',
            reference: 'TEST123'
        };

        // Different parameter formats to try
        const tests = [
            {
                name: "Direct Payment Intent 1",
                url: `intent://payments#Intent;scheme=natwest;package=com.rbs.mobile.android.natwest;S.action=payment;S.sortCode=${testData.sort};S.accountNumber=${testData.account};S.amount=${testData.amount};S.reference=${testData.reference};end`,
                description: "Using payment action with full parameter names"
            },
            {
                name: "Direct Payment Intent 2",
                url: `intent://transfer#Intent;scheme=natwest;package=com.rbs.mobile.android.natwest;S.type=payment;S.sort=${testData.sort};S.acc=${testData.account};S.amount=${testData.amount};S.ref=${testData.reference};end`,
                description: "Using transfer endpoint with short parameter names"
            },
            {
                name: "Market Link with Payment",
                url: `market://details?id=com.rbs.mobile.android.natwest&referrer=payment%3Fsort%3D${testData.sort}%26acc%3D${testData.account}%26amount%3D${testData.amount}%26ref%3D${testData.reference}`,
                description: "Using market link with payment parameters in referrer"
            },
            {
                name: "Payment Through App Links",
                url: `intent://personal.natwest.com/payment#Intent;scheme=https;package=com.rbs.mobile.android.natwest;S.payment_data=${encodeURIComponent(JSON.stringify({
                    sortCode: testData.sort,
                    accountNumber: testData.account,
                    amount: testData.amount,
                    reference: testData.reference
                }))};end`,
                description: "Using app links with JSON payment data"
            },
            {
                name: "Mobile Banking Intent",
                url: `intent://mobilebanking/payment#Intent;scheme=natwest;package=com.rbs.mobile.android.natwest;S.sortCode=${testData.sort};S.accountNumber=${testData.account};S.amount=${testData.amount};S.reference=${testData.reference};end`,
                description: "Using mobilebanking endpoint"
            },
            {
                name: "Simple Payment URI",
                url: `natwest://mobilebanking/payment?sortCode=${testData.sort}&accountNumber=${testData.account}&amount=${testData.amount}&reference=${testData.reference}`,
                description: "Simple URI format with mobilebanking path"
            }
        ];

        const container = document.getElementById('linkTests');

        tests.forEach((test, index) => {
            const div = document.createElement('div');
            div.innerHTML = `
                <button onclick="tryLink(${index})">${test.name}</button>
                <div class="debug">
                    ${test.description}<br>
                    URL: ${test.url}
                </div>
            `;
            container.appendChild(div);
        });

        function tryLink(index) {
            const test = tests[index];
            console.log(`Trying: ${test.name}`);
            console.log(`URL: ${test.url}`);
            
            try {
                window.location.href = test.url;
            } catch (e) {
                console.error('Error opening link:', e);
                alert('Error opening link: ' + e.message);
            }
        }
    </script>
</body>
</html>
